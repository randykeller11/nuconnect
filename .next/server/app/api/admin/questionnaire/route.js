(()=>{var e={};e.id=129,e.ids=[129],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},76926:(e,s,t)=>{"use strict";t.r(s),t.d(s,{patchFetch:()=>m,routeModule:()=>p,serverHooks:()=>c,workAsyncStorage:()=>d,workUnitAsyncStorage:()=>l});var r={};t.r(r),t.d(r,{GET:()=>u});var a=t(96559),n=t(48088),o=t(37719),i=t(32190);async function u(){try{console.log("Fetching questionnaire responses with user data from Supabase...");let e=await fetch(`${process.env.SUPABASE_URL}/rest/v1/questionnaire_responses?select=*,users(id,first_name,last_name,email,phone,relationship_status)&order=submitted_at.desc`,{headers:{Authorization:`Bearer ${process.env.SUPABASE_SERVICE_ROLE_KEY}`,apikey:process.env.SUPABASE_SERVICE_ROLE_KEY,"Content-Type":"application/json"}});if(!e.ok){let s=await e.text();throw console.error("Supabase API error:",e.status,s),Error(`Supabase API error: ${e.status} ${e.statusText}`)}let s=await e.json();console.log("Raw Supabase data with users:",s);let t=s.map(e=>{let s=[];if(e.answers&&"object"==typeof e.answers)for(let[t,r]of Object.entries(e.answers)){let e=t.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase());s.push({questionId:t,question:e,answer:r})}return{id:e.id,userId:e.user_id,answers:s,isComplete:e.is_complete||!1,submittedAt:e.submitted_at,updatedAt:e.updated_at||e.submitted_at,user:e.users?{id:e.users.id,firstName:e.users.first_name,lastName:e.users.last_name,email:e.users.email,phone:e.users.phone,relationshipStatus:e.users.relationship_status}:null}});return console.log("Transformed data with users:",t),i.NextResponse.json(t)}catch(e){return console.error("Error fetching questionnaire responses:",e),i.NextResponse.json({error:"Failed to fetch questionnaire responses"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/admin/questionnaire/route",pathname:"/api/admin/questionnaire",filename:"route",bundlePath:"app/api/admin/questionnaire/route"},resolvedPagePath:"/Users/dub_ceo/Desktop/nuconnect/app/api/admin/questionnaire/route.ts",nextConfigOutput:"",userland:r}),{workAsyncStorage:d,workUnitAsyncStorage:l,serverHooks:c}=p;function m(){return(0,o.patchFetch)({workAsyncStorage:d,workUnitAsyncStorage:l})}},78335:()=>{},96487:()=>{}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[4447,580],()=>t(76926));module.exports=r})();