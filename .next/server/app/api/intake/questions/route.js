(()=>{var e={};e.id=4852,e.ids=[4852],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44325:(e,t,r)=>{"use strict";async function s(e,t="openai/gpt-4o-mini",r=.2){let n=process.env.OPENROUTER_API_KEY;if(!n)throw Error("OPENROUTER_API_KEY missing");let i=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({model:t,messages:e,temperature:r})});if(!i.ok){let e=await i.text();throw Error(`OpenRouter ${i.status}: ${e}`)}let o=await i.json();return o?.choices?.[0]?.message?.content??""}r.d(t,{T:()=>u});class n{getSession(e){return this.sessions.get(e)||null}createSession(e){let t={userId:e,currentStep:0,answers:{},profile:{},createdAt:new Date,updatedAt:new Date};return this.sessions.set(e,t),t}updateSession(e,t){let r={...this.getSession(e)||this.createSession(e),...t,updatedAt:new Date};return this.sessions.set(e,r),r}advanceStep(e,t){let r=this.getSession(e)||this.createSession(e),s={...r.answers,[r.currentStep]:t};return this.updateSession(e,{currentStep:r.currentStep+1,answers:s})}completeIntake(e){if(!this.getSession(e))throw Error("No session found");return this.updateSession(e,{currentStep:-1})}clearSession(e){this.sessions.delete(e)}cleanup(e=24){let t=new Date(Date.now()-60*e*6e4);for(let[e,r]of this.sessions.entries())r.updatedAt<t&&this.sessions.delete(e)}constructor(){this.sessions=new Map}}let i=new n,o=[{id:"name",type:"text",question:"What's your name?",required:!0},{id:"interests",type:"multiselect",question:"What are your main professional interests?",options:["AI","Climate","Fintech","Education","Health","Music","Art","Gaming","Marketing","Operations","Sales","Design","Product","Engineering"],required:!0},{id:"career_goals",type:"select",question:"What's your primary career goal right now?",options:["find-cofounder","explore-jobs","hire","learn-ai","mentor-others","find-mentor","investors","portfolio-feedback"],required:!0},{id:"mentorship",type:"radio",question:"Are you interested in mentorship?",options:["seeking","offering","both","none"],required:!0},{id:"location",type:"text",question:"Where are you based? (City, State/Country)",required:!1}];class a{async getNextQuestion(e){let t=i.getSession(e);return(t||(t=i.createSession(e)),-1===t.currentStep)?null:t.currentStep<o.length?o[t.currentStep]:await this.generateDynamicQuestion(t)}async processAnswer(e,t){try{let r=i.getSession(e);r||(r=i.createSession(e));let s=await this.getCurrentQuestion(r);if(s&&!this.validateAnswer(s,t))return{success:!1,error:"Invalid answer format"};this.updateProfileFromAnswer(r,t);let n=i.advanceStep(e,t);if(this.shouldCompleteIntake(n))return i.completeIntake(e),{success:!0,isComplete:!0};let o=await this.getNextQuestion(e);return{success:!0,nextQuestion:o||void 0,isComplete:!o}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async getCurrentQuestion(e){return e.currentStep<o.length?o[e.currentStep]:null}validateAnswer(e,t){if(e.required&&(!t||""===t))return!1;switch(e.type){case"text":return"string"==typeof t;case"select":case"radio":return e.options?.includes(t)||!1;case"multiselect":return Array.isArray(t)&&t.every(t=>e.options?.includes(t));default:return!0}}updateProfileFromAnswer(e,t){let r=o[e.currentStep];if(r)switch(r.id){case"name":e.profile.name=t;break;case"interests":e.profile.interests=Array.isArray(t)?t:[t];break;case"career_goals":e.profile.careerGoals=t;break;case"mentorship":e.profile.mentorshipPref=t;break;case"location":e.profile.location=t}}shouldCompleteIntake(e){return e.currentStep>=o.length+2}async generateDynamicQuestion(e){try{let t=e.profile,r=[{role:"system",content:`You are helping create personalized networking questions. Based on the user's profile, generate ONE follow-up question that would help match them with relevant professionals. Keep it concise and actionable.

User profile:
- Interests: ${t.interests?.join(", ")||"Not specified"}
- Career goal: ${t.careerGoals||"Not specified"}
- Mentorship: ${t.mentorshipPref||"Not specified"}

Return ONLY a JSON object with this format:
{
  "question": "Your specific question here",
  "type": "text",
  "required": false
}`},{role:"user",content:"Generate a follow-up question for this user."}],n=await s(r,"openai/gpt-4o-mini",.3),i=JSON.parse(n);return{id:`dynamic_${e.currentStep}`,type:i.type||"text",question:i.question,required:i.required||!1}}catch(e){return console.error("Failed to generate dynamic question:",e),null}}}let u=new a},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},57288:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>f,routeModule:()=>c,serverHooks:()=>h,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>d});var s={};r.r(s),r.d(s,{GET:()=>p});var n=r(96559),i=r(48088),o=r(37719),a=r(32190),u=r(44325);async function p(e){try{let{searchParams:t}=new URL(e.url),r=t.get("userId");if(!r)return a.NextResponse.json({error:"Missing userId parameter"},{status:400});let s=await u.T.getNextQuestion(r);if(!s)return a.NextResponse.json({message:"Intake complete",isComplete:!0},{status:200});return a.NextResponse.json({question:s})}catch(e){return console.error("Error getting next question:",e),a.NextResponse.json({error:"Failed to get next question"},{status:500})}}let c=new n.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/intake/questions/route",pathname:"/api/intake/questions",filename:"route",bundlePath:"app/api/intake/questions/route"},resolvedPagePath:"/Users/dub_ceo/Desktop/nuconnect/app/api/intake/questions/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:l,workUnitAsyncStorage:d,serverHooks:h}=c;function f(){return(0,o.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:d})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4447,580],()=>r(57288));module.exports=s})();